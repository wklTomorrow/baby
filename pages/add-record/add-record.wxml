<!--pages/add-record/add-record.wxml-->
<view class="container">
  <!-- 照片上传区域 -->
  <view class="section card">
    <view class="section-title">
      <text class="icon">📷</text>
      <text>添加照片</text>
      <text class="hint">(最多20张)</text>
    </view>
    <view class="photos-grid">
      <view 
        class="photo-item" 
        wx:for="{{photos}}" 
        wx:key="index"
        bindtap="previewPhoto"
        data-index="{{index}}"
      >
        <image class="photo" src="{{item}}" mode="aspectFill"></image>
        <view class="delete-btn" bindtap="deletePhoto" data-index="{{index}}" catchtap="stopPropagation">
          <text class="icon">×</text>
        </view>
      </view>
      <view 
        class="photo-add-btn" 
        wx:if="{{photos.length < 20}}"
        bindtap="choosePhoto"
      >
        <text class="icon">+</text>
        <text class="text">添加照片</text>
      </view>
    </view>
  </view>

  <!-- 视频上传区域 -->
  <view class="section card">
    <view class="section-title">
      <text class="icon">🎥</text>
      <text>添加视频</text>
      <text class="hint">(最多1个)</text>
    </view>
    <view class="video-container" wx:if="{{video}}">
      <video 
        class="video" 
        src="{{video}}" 
        controls
        show-center-play-btn
      ></video>
      <view class="delete-btn" bindtap="deleteVideo">
        <text class="icon">×</text>
      </view>
    </view>
    <view 
      class="video-add-btn" 
      wx:else
      bindtap="chooseVideo"
    >
      <text class="icon">+</text>
      <text class="text">添加视频</text>
    </view>
  </view>

  <!-- 文字输入区域 -->
  <view class="section card">
    <view class="section-title">
      <text class="icon">✏️</text>
      <text>记录文字</text>
    </view>
    <textarea 
      class="text-input" 
      placeholder="记录下今天的美好瞬间..."
      value="{{text}}"
      bindinput="onTextInput"
      maxlength="500"
      auto-height
    ></textarea>
    <view class="text-count">
      <text>{{text.length}}/500</text>
    </view>
  </view>

  <!-- 标签选择区域 -->
  <view class="section card">
    <view class="section-title">
      <text class="icon">🏷️</text>
      <text>添加标签</text>
    </view>
    <view class="tags-container">
      <view 
        class="tag {{item.selected ? 'active' : ''}}"
        wx:for="{{availableTags}}"
        wx:key="name"
        bindtap="toggleTag"
        data-name="{{item.name}}"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- 保存按钮 -->
  <view class="save-btn-container safe-area-bottom">
    <button class="save-btn btn-primary" bindtap="saveRecord" disabled="{{saving}}">
      <text wx:if="{{saving}}">保存中...</text>
      <text wx:else>保存记录</text>
    </button>
  </view>
</view>

