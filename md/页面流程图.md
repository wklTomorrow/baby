# 成长时光盒 - 页面流程图

## 1. 整体页面结构

```
┌─────────────────────────────────────┐
│           成长时光盒小程序            │
├─────────────────────────────────────┤
│                                     │
│  ┌──────────┐  ┌──────────┐        │
│  │  首页    │  │ 个人中心 │        │
│  │ (日历页) │  │          │        │
│  └──────────┘  └──────────┘        │
│       │              │              │
│       │              │              │
│  ┌──────────┐  ┌──────────┐        │
│  │记录详情页│  │ 设置页面 │        │
│  └──────────┘  └──────────┘        │
│       │                             │
│       │                             │
│  ┌──────────┐  ┌──────────┐        │
│  │添加记录页│  │记录列表页│        │
│  └──────────┘  └──────────┘        │
│                                     │
└─────────────────────────────────────┘
```

## 2. 主要页面流程

### 2.1 首页（日历页）流程

```
首页（日历页）
    │
    ├─→ 点击日期 → 记录详情页
    │       │
    │       └─→ 无记录 → 添加记录页
    │
    ├─→ 点击"查看今日记录" → 记录列表页（筛选今日）
    │
    ├─→ 点击"添加今日记录" → 添加记录页
    │
    └─→ 点击"设置" → 个人中心页
```

### 2.2 添加记录流程

```
添加记录页
    │
    ├─→ 选择照片（拍照/相册）
    │       │
    │       └─→ 照片预览 → 可删除
    │
    ├─→ 选择视频（拍摄/相册）
    │       │
    │       └─→ 视频预览 → 可删除
    │
    ├─→ 输入文字
    │       │
    │       └─→ 字数统计显示
    │
    ├─→ 选择标签（可选）
    │
    └─→ 点击"保存" → 保存成功 → 返回首页/记录详情页
```

### 2.3 查看记录流程

```
记录详情页
    │
    ├─→ 查看照片 → 左右滑动切换
    │
    ├─→ 播放视频 → 播放控制
    │
    ├─→ 查看文字内容
    │
    ├─→ 点击"编辑" → 编辑记录页
    │       │
    │       └─→ 保存修改 → 返回详情页
    │
    ├─→ 点击"删除" → 确认对话框 → 删除成功 → 返回首页
    │
    └─→ 点击"分享" → 分享到微信
```

### 2.4 记录列表流程

```
记录列表页
    │
    ├─→ 下拉刷新 → 重新加载数据
    │
    ├─→ 上拉加载 → 加载更多记录
    │
    ├─→ 点击筛选标签 → 切换筛选条件
    │       │
    │       ├─→ 全部
    │       ├─→ 照片
    │       ├─→ 视频
    │       └─→ 文字
    │
    ├─→ 点击搜索 → 搜索框 → 输入关键词 → 搜索结果
    │
    └─→ 点击记录卡片 → 记录详情页
```

### 2.5 个人中心流程

```
个人中心页
    │
    ├─→ 点击头像 → 更换头像
    │
    ├─→ 点击"宝宝信息" → 编辑宝宝信息页
    │       │
    │       ├─→ 修改昵称
    │       ├─→ 修改生日
    │       └─→ 保存
    │
    ├─→ 点击"数据备份" → 备份到云端
    │
    ├─→ 点击"数据导出" → 选择格式 → 导出
    │
    ├─→ 点击"隐私设置" → 隐私设置页
    │
    └─→ 点击"关于我们" → 关于页面
```

## 3. 用户操作流程示例

### 3.1 新用户首次使用流程

```
启动小程序
    │
    ├─→ 授权登录
    │
    ├─→ 设置宝宝信息（昵称、生日、头像）
    │
    └─→ 进入首页 → 引导添加第一条记录
```

### 3.2 每日记录流程

```
打开小程序
    │
    └─→ 首页（日历页）
            │
            ├─→ 查看今日是否有记录
            │       │
            │       ├─→ 有记录 → 点击查看 → 记录详情页
            │       │
            │       └─→ 无记录 → 点击"添加今日记录"
            │
            └─→ 添加记录页
                    │
                    ├─→ 拍照/选择照片
                    ├─→ 输入文字描述
                    ├─→ 选择标签（可选）
                    └─→ 保存 → 返回首页
```

### 3.3 查看历史记录流程

```
首页（日历页）
    │
    ├─→ 点击日历上的日期（有记录标记）
    │       │
    │       └─→ 记录详情页 → 查看该日期的记录
    │
    └─→ 点击"查看今日记录" → 记录列表页
            │
            ├─→ 浏览所有记录
            ├─→ 使用筛选功能
            ├─→ 使用搜索功能
            └─→ 点击记录 → 记录详情页
```

## 4. 异常流程

### 4.1 网络异常

```
操作中网络断开
    │
    └─→ 显示提示："网络连接失败，请检查网络"
            │
            └─→ 数据保存到本地 → 网络恢复后自动同步
```

### 4.2 存储空间不足

```
上传照片/视频
    │
    └─→ 检测到存储空间不足
            │
            └─→ 提示："存储空间不足，请清理空间后重试"
```

### 4.3 删除确认

```
点击删除
    │
    └─→ 弹出确认对话框
            │
            ├─→ 确认 → 删除成功 → 返回
            │
            └─→ 取消 → 返回详情页
```

## 5. 页面跳转关系图

```
                    ┌──────────┐
                    │   首页   │
                    │ (日历页) │
                    └────┬─────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
  ┌──────────┐    ┌──────────┐    ┌──────────┐
  │添加记录页│    │记录详情页│    │个人中心页│
  └────┬─────┘    └────┬─────┘    └────┬─────┘
       │               │                │
       │               │                ▼
       │               │          ┌──────────┐
       │               │          │ 设置页面 │
       │               │          └──────────┘
       │               │
       └───────┬───────┘
               │
               ▼
        ┌──────────┐
        │记录列表页│
        └──────────┘
```

## 6. 数据流向

### 6.1 数据保存流程

```
用户输入数据
    │
    ├─→ 照片/视频 → 压缩处理 → 上传到云存储 → 获取URL
    │
    ├─→ 文字内容 → 本地验证 → 保存到本地存储
    │
    └─→ 组合数据 → 保存记录对象 → 更新日历标记
```

### 6.2 数据加载流程

```
打开首页
    │
    └─→ 从本地存储加载记录列表
            │
            ├─→ 解析记录数据
            ├─→ 生成日历标记
            └─→ 渲染页面
```

### 6.3 数据同步流程（可选）

```
本地数据
    │
    ├─→ 检测网络状态
    │       │
    │       ├─→ 有网络 → 上传到云端 → 同步成功
    │       │
    │       └─→ 无网络 → 保存到本地队列 → 等待同步
    │
    └─→ 从云端拉取最新数据 → 合并本地数据
```

## 7. 关键交互点

### 7.1 日历交互
- **点击日期**：跳转到该日期的记录详情页
- **左右滑动**：切换月份（可选）
- **长按日期**：快速添加记录（可选）

### 7.2 照片/视频交互
- **点击上传区域**：弹出选择菜单
- **长按已上传内容**：显示删除选项
- **点击照片**：全屏预览，支持左右滑动
- **点击视频**：播放/暂停

### 7.3 列表交互
- **下拉刷新**：重新加载数据
- **上拉加载**：加载更多记录
- **左滑删除**：快速删除记录（可选）

## 8. 状态说明

### 8.1 加载状态
- 页面加载：显示骨架屏
- 数据加载：显示加载动画
- 上传中：显示进度条

### 8.2 空状态
- 无记录：显示引导文案和添加按钮
- 搜索无结果：显示"暂无相关记录"
- 网络错误：显示错误提示和重试按钮

### 8.3 成功状态
- 保存成功：显示成功提示（Toast）
- 删除成功：显示成功提示并刷新列表
- 分享成功：显示成功提示

